your_string = """0,2,file~GifHeader~Signature
3,5,file~GifHeader~Version
0,5,file~GifHeader
6,7,file~LogicalScreenDescriptor~Width
8,9,file~LogicalScreenDescriptor~Height
10,10,file~LogicalScreenDescriptor~PackedFields~GlobalColorTableFlag
10,10,file~LogicalScreenDescriptor~PackedFields~ColorResolution
10,10,file~LogicalScreenDescriptor~PackedFields~SortFlag
10,10,file~LogicalScreenDescriptor~PackedFields~SizeOfGlobalColorTable
10,10,file~LogicalScreenDescriptor~PackedFields
11,11,file~LogicalScreenDescriptor~BackgroundColorIndex
12,12,file~LogicalScreenDescriptor~PixelAspectRatio
6,12,file~LogicalScreenDescriptor
13,13,file~GlobalColorTable~rgb~R
14,14,file~GlobalColorTable~rgb~G
15,15,file~GlobalColorTable~rgb~B
16,16,file~GlobalColorTable~rgb~R_1
17,17,file~GlobalColorTable~rgb~G_1
18,18,file~GlobalColorTable~rgb~B_1
19,19,file~GlobalColorTable~rgb~R_2
20,20,file~GlobalColorTable~rgb~G_2
21,21,file~GlobalColorTable~rgb~B_2
22,22,file~GlobalColorTable~rgb~R_3
23,23,file~GlobalColorTable~rgb~G_3
24,24,file~GlobalColorTable~rgb~B_3
13,24,file~GlobalColorTable~rgb
13,24,file~GlobalColorTable
25,25,file~Data~ImageDescriptor~ImageSeperator
26,27,file~Data~ImageDescriptor~ImageLeftPosition
28,29,file~Data~ImageDescriptor~ImageTopPosition
30,31,file~Data~ImageDescriptor~ImageWidth
32,33,file~Data~ImageDescriptor~ImageHeight
34,34,file~Data~ImageDescriptor~PackedFields~LocalColorTableFlag
34,34,file~Data~ImageDescriptor~PackedFields~InterlaceFlag
34,34,file~Data~ImageDescriptor~PackedFields~SortFlag
34,34,file~Data~ImageDescriptor~PackedFields~Reserved
34,34,file~Data~ImageDescriptor~PackedFields~SizeOfLocalColorTable
34,34,file~Data~ImageDescriptor~PackedFields
25,34,file~Data~ImageDescriptor,Optional
35,35,file~Data~LocalColorTable~rgb~R
36,36,file~Data~LocalColorTable~rgb~G
37,37,file~Data~LocalColorTable~rgb~B
38,38,file~Data~LocalColorTable~rgb~R_1
39,39,file~Data~LocalColorTable~rgb~G_1
40,40,file~Data~LocalColorTable~rgb~B_1
41,41,file~Data~LocalColorTable~rgb~R_2
42,42,file~Data~LocalColorTable~rgb~G_2
43,43,file~Data~LocalColorTable~rgb~B_2
44,44,file~Data~LocalColorTable~rgb~R_3
45,45,file~Data~LocalColorTable~rgb~G_3
46,46,file~Data~LocalColorTable~rgb~B_3
47,47,file~Data~LocalColorTable~rgb~R_4
48,48,file~Data~LocalColorTable~rgb~G_4
49,49,file~Data~LocalColorTable~rgb~B_4
50,50,file~Data~LocalColorTable~rgb~R_5
51,51,file~Data~LocalColorTable~rgb~G_5
52,52,file~Data~LocalColorTable~rgb~B_5
53,53,file~Data~LocalColorTable~rgb~R_6
54,54,file~Data~LocalColorTable~rgb~G_6
55,55,file~Data~LocalColorTable~rgb~B_6
56,56,file~Data~LocalColorTable~rgb~R_7
57,57,file~Data~LocalColorTable~rgb~G_7
58,58,file~Data~LocalColorTable~rgb~B_7
35,58,file~Data~LocalColorTable~rgb
35,58,file~Data~LocalColorTable
59,59,file~Data~ImageData~LZWMinimumCodeSize
60,60,file~Data~ImageData~DataSubBlocks~DataSubBlock~Size
61,127,file~Data~ImageData~DataSubBlocks~DataSubBlock~Data
60,127,file~Data~ImageData~DataSubBlocks~DataSubBlock,Optional
128,128,file~Data~ImageData~DataSubBlocks~DataSubBlock_1~Size
129,222,file~Data~ImageData~DataSubBlocks~DataSubBlock_1~Data
128,222,file~Data~ImageData~DataSubBlocks~DataSubBlock_1,Optional
223,223,file~Data~ImageData~DataSubBlocks~DataSubBlock_2~Size
224,247,file~Data~ImageData~DataSubBlocks~DataSubBlock_2~Data
223,247,file~Data~ImageData~DataSubBlocks~DataSubBlock_2,Optional
248,248,file~Data~ImageData~DataSubBlocks~DataSubBlock_3~Size
249,390,file~Data~ImageData~DataSubBlocks~DataSubBlock_3~Data
248,390,file~Data~ImageData~DataSubBlocks~DataSubBlock_3,Optional
391,391,file~Data~ImageData~DataSubBlocks~DataSubBlock_4~Size
392,507,file~Data~ImageData~DataSubBlocks~DataSubBlock_4~Data
391,507,file~Data~ImageData~DataSubBlocks~DataSubBlock_4,Optional
508,508,file~Data~ImageData~DataSubBlocks~DataSubBlock_5~Size
509,638,file~Data~ImageData~DataSubBlocks~DataSubBlock_5~Data
508,638,file~Data~ImageData~DataSubBlocks~DataSubBlock_5,Optional
639,639,file~Data~ImageData~DataSubBlocks~DataSubBlock_6~Size
640,763,file~Data~ImageData~DataSubBlocks~DataSubBlock_6~Data
639,763,file~Data~ImageData~DataSubBlocks~DataSubBlock_6,Optional
764,764,file~Data~ImageData~DataSubBlocks~DataSubBlock_7~Size
765,858,file~Data~ImageData~DataSubBlocks~DataSubBlock_7~Data
764,858,file~Data~ImageData~DataSubBlocks~DataSubBlock_7,Optional
859,859,file~Data~ImageData~DataSubBlocks~DataSubBlock_8~Size
860,948,file~Data~ImageData~DataSubBlocks~DataSubBlock_8~Data
859,948,file~Data~ImageData~DataSubBlocks~DataSubBlock_8,Optional
949,949,file~Data~ImageData~DataSubBlocks~DataSubBlock_9~Size
950,1096,file~Data~ImageData~DataSubBlocks~DataSubBlock_9~Data
949,1096,file~Data~ImageData~DataSubBlocks~DataSubBlock_9,Optional
1097,1097,file~Data~ImageData~DataSubBlocks~DataSubBlock_10~Size
1098,1251,file~Data~ImageData~DataSubBlocks~DataSubBlock_10~Data
1097,1251,file~Data~ImageData~DataSubBlocks~DataSubBlock_10,Optional
1252,1252,file~Data~ImageData~DataSubBlocks~DataSubBlock_11~Size
1253,1506,file~Data~ImageData~DataSubBlocks~DataSubBlock_11~Data
1252,1506,file~Data~ImageData~DataSubBlocks~DataSubBlock_11,Optional
1507,1507,file~Data~ImageData~DataSubBlocks~DataSubBlock_12~Size
1508,1624,file~Data~ImageData~DataSubBlocks~DataSubBlock_12~Data
1507,1624,file~Data~ImageData~DataSubBlocks~DataSubBlock_12,Optional
1625,1625,file~Data~ImageData~DataSubBlocks~DataSubBlock_13~Size
1626,1697,file~Data~ImageData~DataSubBlocks~DataSubBlock_13~Data
1625,1697,file~Data~ImageData~DataSubBlocks~DataSubBlock_13,Optional
1698,1698,file~Data~ImageData~DataSubBlocks~BlockTerminator,Optional
60,1698,file~Data~ImageData~DataSubBlocks
59,1698,file~Data~ImageData
25,1698,file~Data,Appendable
1699,1699,file~Trailer~GIFTrailer
1699,1699,file~Trailer
"""

lines = your_string.splitlines()

entries = []

# Step 1: Parse all lines into structured format
for line in lines:
    parts = line.split(',')
    if len(parts) < 3:
        continue  # Skip bad lines
    start, end, label = int(parts[0]), int(parts[1]), parts[2]
    entries.append((start, end, label, line))

# Step 2: Sort entries by start byte
# Step 2: Sort by start ASCENDING and end DESCENDING
entries.sort(key=lambda x: (x[0], -x[1]))

print("Sorted Entries:")
print("\n".join(line for _, _, _, line in entries))

# Step 3: Filter out child entries
filtered = []
current_parent_end = -1

for start, end, label, line in entries:

    # Split attribute into hierarchical keys
    attribute_keys = label.split("~")

                # Skip if the attribute path has only two levels (e.g., "file~GifHeader")
                # if len(attribute_keys) <= 2:
                #     continue

    if start == end and "_" in label:
        continue

    if (start > current_parent_end or end < current_parent_end) and end - start <= 8:
        # No overlap with previous parent
        filtered.append(line)
        current_parent_end = end
    else:
        # This entry is inside an earlier parent, so skip
        continue

# `filtered` now has your required lines

print("Filtered Entries:")
print("\n".join(filtered))